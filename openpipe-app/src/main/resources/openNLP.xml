<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:util="http://www.springframework.org/schema/util"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
       http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-2.0.xsd
       http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.0.xsd">

   <bean id="pipeline" class="no.trank.openpipe.api.Pipeline">
      <property name="pipelineSteps">
         <list>
<!--
            <bean class="no.trank.openpipe.step.AnnotateSentence">
               <property name="fieldNames" value="uppercaseBody"/>
            </bean>
-->
            <ref bean="onlpTokenizer"/>
            <ref bean="onlpSentenceDetector"/>
            <ref bean="onlpNEDetector"/>
            <bean class="no.trank.openpipe.step.Debug">
               <property name="annotationTypes">
                  <set>
                     <value>opennlp.ne.person</value>
                     <value>opennlp.ne.location</value>
                  </set>
               </property>
               <property name="showFieldValue" value="false"/>
            </bean>
         </list>
      </property>
   </bean>

   <bean id="textFileDocumentReader" class="no.trank.openpipe.reader.TextFileDocumentReader">
      <property name="directory" value="pipeline-app/src/main/resources/docs"/>
      <property name="encoding" value="UTF-8"/>
      <property name="bodyField" value="body"/>
   </bean>

   <bean id="pipelineApplicationBean" class="no.trank.openpipe.PipelineRunner">
      <property name="documentReader">
         <ref local="textFileDocumentReader"/>
      </property>
      <property name="pipeline">
         <ref local="pipeline"/>
      </property>
   </bean>

   <import resource="opennlpContext.xml"/>
   
   <bean id="onlpTokenizer" class="no.trank.openpipe.opennlp.step.ONLPTokenizer">
      <property name="tokenizer" ref="tokenizer"/>
      <property name="fieldNames" value="body"/>
      <property name="name" value="OpenNLP Tokenizer"/>
   </bean>
   
   <bean id="onlpSentenceDetector" class="no.trank.openpipe.opennlp.step.ONLPSentenceDetector">
      <property name="detector" ref="detector"/>
      <property name="fieldNames" value="body"/>
      <property name="name" value="OpenNLP Sentence Detector"/>
   </bean>
   
   <bean id="onlpNEDetector" class="no.trank.openpipe.opennlp.step.ONLPNEDetector">
      <property name="nameFinders">
         <map>
            <entry key="person" value-ref="nameFinderPerson"/>
            <entry key="location" value-ref="nameFinderLocation"/>
         </map>
      </property>
      <property name="fieldNames" value="body"/>
      <property name="name" value="OpenNLP NE Detector"/>
   </bean>
   
</beans>